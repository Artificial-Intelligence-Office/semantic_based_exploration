<?xml version="1.0" ?>
<launch>
	  <arg name="ns" 		default="rtabmap"/>
	  <arg name="rviz"              default="true" />
	  <arg name="args"              default="--delete_db_on_start"/>
	  <arg name="database_path"     default="rtabmap.db"/>
	  <arg name="localization"      default="false"/>
	  <arg name="rtabmapviz"        default="true" /> 
	  <group ns="$(arg ns)">
		    <node name="rtabmap" pkg="rtabmap_ros" type="rtabmap" output="screen" args="$(arg args)">
			  <param name="database_path"       type="string" value="$(arg database_path)"/>
			  <param name="frame_id"            type="string" value="kinect1_depth_optical_frame"/>
			  <param name="odom_frame_id"       type="string" value="world"/>
			  <!--param name="wait_for_transform"  type="bool"   value="true"/>-->
			  <param name="subscribe_depth"     type="bool"   value="true"/>
			  <!--param name="subscribe_laserScan" type="bool"   value="true"/>-->
			  <remap from="odom" to="fcu"/>
			  <!-- inputs -->
			  <!--remap from="scan" to="/scan"/>-->
			  <remap from="rgb/image"       to="/front_camera/rgb/image_raw"/>
		  	  <remap from="depth/image"     to="/front_camera/depth/image_raw"/>
		  	  <remap from="rgb/camera_info" to="/front_camera/rgb/camera_info"/>
		  	  <!--remap from="rtabmap/get_map" to="/iris/get_map"/>-->
			  <param name="Kp/WordsPerImage" type="string" value="-1"/>
			  <!-- localization mode -->
			  <param     if="$(arg localization)" name="Mem/IncrementalMemory" type="string" value="false"/>
			  <param unless="$(arg localization)" name="Mem/IncrementalMemory" type="string" value="true"/>
			  <param name="Mem/InitWMWithAllNodes" type="string" value="$(arg localization)"/> 
		    </node>
		    <node if="$(arg rtabmapviz)" pkg="rtabmap_ros" type="rtabmapviz" name="rtabmapviz" args="-d $(find rtabmap_ros)/launch/config/rgbd_gui.ini" output="screen">
		      <param name="subscribe_depth"     type="bool"   value="true"/>
		      <!--param name="subscribe_odom_info" type="bool"   value="$(arg odom_info_data)"/>-->
		      <param name="frame_id"            type="string" value="kinect1_depth_optical_frame"/>
		      <param name="wait_for_transform"  type="bool"   value="true"/>
		    
			  <remap from="rgb/image"       to="/front_camera/rgb/image_raw"/>
		  	  <remap from="depth/image"     to="/front_camera/depth/image_raw"/>
		  	  <remap from="rgb/camera_info" to="/front_camera/rgb/camera_info"/>
		    </node>
		    <!--node if="$(arg rviz)" pkg="rviz" type="rviz" name="rviz" args="-d $(find kuri_usar_sim)/config/rviz/rgbd_rqt.rviz"/-->
		    <!-- sync cloud with odometry and voxelize the point cloud (for fast visualization in rviz) -->
		    <node if="$(arg rviz)" pkg="nodelet" type="nodelet" name="points_xyzrgb" args="load rtabmap_ros/point_cloud_xyzrgb standalone_nodelet">
			  <remap from="rgb/image"       to="/front_camera/rgb/image_raw"/>
		  	  <remap from="depth/image"     to="/front_camera/depth/image_raw"/>
		  	  <remap from="rgb/camera_info" to="/front_camera/rgb/camera_info"/>
			  <remap from="cloud"           to="voxel_cloud" />
			  <!--remap from="rtabmap/get_map" to="/iris/get_map"/>-->
			  <!--param name="decimation" type="double" value="2"/>
			  <param name="voxel_size" type="double" value="0.02"/>
			  <param name="RGBD/LocalImmunizationRatio"  type="string" value="0.5"/>   --> 
		    </node>
	</group>
</launch>
